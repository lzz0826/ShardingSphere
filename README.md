# ShardingSphere
<br /><br />
# 初期阶段：垂直分库和垂直分表
# 后期阶段：水平分库和水平分表

<br />

# 垂直拆分
將業務的不同分類，不同的業務劃分到不同的應用。這種拆分往往是根據系統的改造，將原來的功能模組依照更細粒度的拆分成多個弱耦合的服務

## 垂直分库：
按照业务模块将数据分散到不同的数据库中，每个数据库存储一个业务模块的数据。

假设我们有一个外賣系统，包含 商品管理 订单管理 用户管理 三个主要业务模块。我们可以按照业务将数据垂直拆分成三个数据库：
![image](https://raw.githubusercontent.com/lzz0826/ShardingSphere/main/images/002.webp)
垂直拆分就是要把表按功能模块划分到不同数据库中，如果你的系统是分布式微服务的架构，那就更好理解了，一般一个微服务对应这一个或多个数据库。比如电商系统一般都会有用户中心、订单、商品等等。用户中心数据库存的都是用户信息相关的，商品数据库存的都是商品相关的数据，订单数据库则是存的订单相关的。

## 垂直分表：
将一个表中的列按照不同的业务逻辑拆分成多个表，以减少单个表的宽度，提高查询性能。

设我们有一个用户表 users，包含用户的基本信息和详细信息。为了优化查询，我们可以将用户表垂直拆分成两个表：

![image](https://raw.githubusercontent.com/lzz0826/ShardingSphere/main/images/001.png)
垂直分表是将一张数据表的字段，拆成两张或两张以上的数据进行存放。这样做的目的一个是避免一张表存的字段太多，单条数据的数据量大，不仅会占用更多的物理内容，还会降低查询的性能。而且有些字段查询的不是很频繁，有些字段查询的很频繁，那我们就可以将这查询频繁和查询不频繁的字段分开存放。这样就可以避免磁盘进行不必要的IO，提高系统的性能。我们一般都是把查询频繁的字段放到主表中，查询不频繁且不是很重要的字段放到扩展表中。主表和扩展表是1对1的关系，之间用主键进行关联。

## 垂直分表的优缺点总结如下：
### 优点：

- 解耦业务逻辑： 垂直分表可以将数据按照业务逻辑进行划分，降低系统的耦合度，使得每张表只需关注特定的业务需求，提升了系统的可维护性和可扩展性。<br />

- 性能优化： 某些情况下，垂直分表可以提升性能。例如，将频繁访问的字段（如用户名、密码等）与不经常访问的字段（如地址、电话等）分开存储，可以减少数据库查询的IO消耗。<br />

- 管理与监控： 通过垂直分表，可以更精细地管理和监控数据库的使用情况。每个表都可以有独立的索引、统计信息和备份策略，从而更好地优化数据库的性能和可用性。<br />

- 并发处理改善： 在高并发场景下，垂直分表可以一定程度上减少单表的并发访问压力，提升系统的响应速度和并发处理能力。<br />

### 缺点：

- 数据关联复杂性增加： 垂直分表会导致数据的关联查询复杂化，例如，需要通过多个接口或者服务来聚合数据，增加了开发和维护的复杂度。<br />

- 分布式事务处理困难： 垂直分表可能会增加分布式事务处理的难度，因为涉及到跨多个表的操作，需要额外的管理和处理。<br />

- 单表数据量问题未解决： 垂直分表虽然解决了部分表结构的问题，但对于单表数据量过大的情况，依然需要考虑水平切分（即按行切分）的策略，这在大数据量或高访问压力下仍然是一个挑战。<br />

# 水平拆分

## 库内分表：
![image](https://github.com/lzz0826/EventualConsistency/blob/main/img/10.png)

## 分库分表：
![image](https://github.com/lzz0826/EventualConsistency/blob/main/img/10.png)


